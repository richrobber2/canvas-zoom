import{S as le,i as ie,s as x,A as $,B as g,f as y,D as X,E as V,p as S,a6 as Rt,F as N,K as J,q as we,b as q,w as Ft,a3 as nt,ah as at,a5 as ut,C as Dt,O,I as Y,L as Ve,ad as Lt,a2 as st,G as W,ak as Mt,o as k,k as re,t as I,n as ne,N as qt,r as Tt,V as Ce,ac as jt,x as ke,c as E,m as B,l as v,M as Ye,an as Ut,e as me,j as G,a as Z,W as Wt,X as Nt,Y as Pt,Z as Ot,v as Ht,a7 as Yt,g as Xt,h as Vt}from"./index.6ea40ad4.js";import{a as Jt}from"./Empty.svelte_svelte_type_style_lang.baac4a84.js";import{B as Et}from"./BlockLabel.8e6f29bb.js";/* empty css                                                    */import{I as Xe}from"./Image.dcca1818.js";import{C as Qt,i as Gt,U as Zt,W as Kt}from"./StaticImage.svelte_svelte_type_style_lang.d730c9a6.js";import{I as ye,C as $t,M as Je}from"./ModifyUpload.abaf0111.js";import{C as xt}from"./Copy.feac0cb6.js";import{U as er}from"./Upload.54d3ada0.js";import{E as tr}from"./Empty.0092c5bc.js";import{D as rr}from"./Download.c746eeca.js";import"./Blocks.b6782001.js";import{U as nr}from"./UploadText.2d17a8af.js";import{E as kn}from"./Image.3076c988.js";import"./ModifyUpload.svelte_svelte_type_style_lang.e946db2d.js";function sr(t){let e,r,n;return{c(){e=$("svg"),r=$("path"),n=$("path"),g(r,"d","M28.828 3.172a4.094 4.094 0 0 0-5.656 0L4.05 22.292A6.954 6.954 0 0 0 2 27.242V30h2.756a6.952 6.952 0 0 0 4.95-2.05L28.828 8.829a3.999 3.999 0 0 0 0-5.657zM10.91 18.26l2.829 2.829l-2.122 2.121l-2.828-2.828zm-2.619 8.276A4.966 4.966 0 0 1 4.756 28H4v-.759a4.967 4.967 0 0 1 1.464-3.535l1.91-1.91l2.829 2.828zM27.415 7.414l-12.261 12.26l-2.829-2.828l12.262-12.26a2.047 2.047 0 0 1 2.828 0a2 2 0 0 1 0 2.828z"),g(r,"fill","currentColor"),g(n,"d","M6.5 15a3.5 3.5 0 0 1-2.475-5.974l3.5-3.5a1.502 1.502 0 0 0 0-2.121a1.537 1.537 0 0 0-2.121 0L3.415 5.394L2 3.98l1.99-1.988a3.585 3.585 0 0 1 4.95 0a3.504 3.504 0 0 1 0 4.949L5.439 10.44a1.502 1.502 0 0 0 0 2.121a1.537 1.537 0 0 0 2.122 0l4.024-4.024L13 9.95l-4.025 4.024A3.475 3.475 0 0 1 6.5 15z"),g(n,"fill","currentColor"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 32 32")},m(l,o){y(l,e,o),X(e,r),X(e,n)},p:V,i:V,o:V,d(l){l&&S(e)}}}class lr extends le{constructor(e){super(),ie(this,e,null,sr,x,{})}}function ir(t){let e,r,n,l,o,s,a;return{c(){e=$("svg"),r=$("circle"),n=$("circle"),l=$("circle"),o=$("circle"),s=$("circle"),a=$("path"),g(r,"cx","10"),g(r,"cy","12"),g(r,"r","2"),g(r,"fill","currentColor"),g(n,"cx","16"),g(n,"cy","9"),g(n,"r","2"),g(n,"fill","currentColor"),g(l,"cx","22"),g(l,"cy","12"),g(l,"r","2"),g(l,"fill","currentColor"),g(o,"cx","23"),g(o,"cy","18"),g(o,"r","2"),g(o,"fill","currentColor"),g(s,"cx","19"),g(s,"cy","23"),g(s,"r","2"),g(s,"fill","currentColor"),g(a,"fill","currentColor"),g(a,"d","M16.54 2A14 14 0 0 0 2 16a4.82 4.82 0 0 0 6.09 4.65l1.12-.31a3 3 0 0 1 3.79 2.9V27a3 3 0 0 0 3 3a14 14 0 0 0 14-14.54A14.05 14.05 0 0 0 16.54 2Zm8.11 22.31A11.93 11.93 0 0 1 16 28a1 1 0 0 1-1-1v-3.76a5 5 0 0 0-5-5a5.07 5.07 0 0 0-1.33.18l-1.12.31A2.82 2.82 0 0 1 4 16A12 12 0 0 1 16.47 4A12.18 12.18 0 0 1 28 15.53a11.89 11.89 0 0 1-3.35 8.79Z"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 32 32")},m(i,_){y(i,e,_),X(e,r),X(e,n),X(e,l),X(e,o),X(e,s),X(e,a)},p:V,i:V,o:V,d(i){i&&S(e)}}}class or extends le{constructor(e){super(),ie(this,e,null,ir,x,{})}}function ar(t){let e,r;return{c(){e=$("svg"),r=$("path"),g(r,"d","M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"width","100%"),g(e,"height","100%"),g(e,"viewBox","0 0 24 24"),g(e,"fill","none"),g(e,"stroke","currentColor"),g(e,"stroke-width","1.5"),g(e,"stroke-linecap","round"),g(e,"stroke-linejoin","round"),g(e,"class","feather feather-edit-2")},m(n,l){y(n,e,l),X(e,r)},p:V,i:V,o:V,d(n){n&&S(e)}}}class ft extends le{constructor(e){super(),ie(this,e,null,ar,x,{})}}function ur(t){let e,r;return{c(){e=N("img"),J(e.src,r=t[0])||g(e,"src",r),g(e,"alt","")},m(n,l){y(n,e,l),t[4](e)},p(n,[l]){l&1&&!J(e.src,r=n[0])&&g(e,"src",r)},i:V,o:V,d(n){n&&S(e),t[4](null)}}}function fr(t,e,r){let{image:n}=e,l;const o=we();let s;function a(){s.destroy()}function i(){s&&a(),s=new Qt(l,{autoCropArea:1,cropend(){const f=s.getCroppedCanvas().toDataURL();o("crop",f)}}),o("crop",n)}function _(f){q[f?"unshift":"push"](()=>{l=f,r(1,l)})}return t.$$set=f=>{"image"in f&&r(0,n=f.image)},[n,l,a,i,_]}class Bt extends le{constructor(e){super(),ie(this,e,fr,ur,x,{image:0,destroy:2,create:3})}get image(){return this.$$.ctx[0]}set image(e){this.$$set({image:e}),Rt()}get destroy(){return this.$$.ctx[2]}get create(){return this.$$.ctx[3]}}class _t{constructor(e,r){this.x=e,this.y=r}}class ct extends _t{update(e){this.x=e.x,this.y=e.y}moveByAngle(e,r){const n=e+Math.PI/2;this.x=this.x+Math.sin(n)*r,this.y=this.y-Math.cos(n)*r}equalsTo(e){return this.x===e.x&&this.y===e.y}getDifferenceTo(e){return new _t(this.x-e.x,this.y-e.y)}getDistanceTo(e){const r=this.getDifferenceTo(e);return Math.sqrt(Math.pow(r.x,2)+Math.pow(r.y,2))}getAngleTo(e){const r=this.getDifferenceTo(e);return Math.atan2(r.y,r.x)}toObject(){return{x:this.x,y:this.y}}}const _r=30;class cr{constructor({radius:e=_r,enabled:r=!0,initialPoint:n={x:0,y:0}}={}){this.radius=e,this._isEnabled=r,this.pointer=new ct(n.x,n.y),this.brush=new ct(n.x,n.y),this.angle=0,this.distance=0,this._hasMoved=!1}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}isEnabled(){return this._isEnabled}setRadius(e){this.radius=e}getRadius(){return this.radius}getBrushCoordinates(){return this.brush.toObject()}getPointerCoordinates(){return this.pointer.toObject()}getBrush(){return this.brush}getPointer(){return this.pointer}getAngle(){return this.angle}getDistance(){return this.distance}brushHasMoved(){return this._hasMoved}update(e,{both:r=!1}={}){return this._hasMoved=!1,this.pointer.equalsTo(e)&&!r?!1:(this.pointer.update(e),r?(this._hasMoved=!0,this.brush.update(e),!0):(this._isEnabled?(this.distance=this.pointer.getDistanceTo(this.brush),this.angle=this.pointer.getAngleTo(this.brush),this.distance>this.radius&&(this.brush.moveByAngle(this.angle,this.distance-this.radius),this._hasMoved=!0)):(this.distance=0,this.angle=0,this.brush.update(e),this._hasMoved=!0),!0))}}const vt=Ft("#000000");function ht(t,e,r){const n=t.slice();return n[69]=e[r].name,n[70]=e[r].zIndex,n[71]=e,n[72]=r,n}function mt(t){let e,r,n;return{c(){e=N("div"),e.textContent="Start drawing",g(e,"class","start-prompt svelte-1g1hqr7")},m(l,o){y(l,e,o),n=!0},i(l){n||(nt(()=>{r||(r=at(e,ut,{duration:50},!0)),r.run(1)}),n=!0)},o(l){r||(r=at(e,ut,{duration:50},!1)),r.run(0),n=!1},d(l){l&&S(e),l&&r&&r.end()}}}function gt(t){let e,r,n=t[69],l,o;const s=()=>t[32](e,n),a=()=>t[32](null,n);return{c(){e=N("canvas"),g(e,"key",r=t[69]),Dt(e,"z-index",t[70]),g(e,"class","svelte-1g1hqr7"),O(e,"lr",t[7]),O(e,"tb",!t[7])},m(i,_){y(i,e,_),s(),l||(o=[Y(e,"mousedown",t[69]==="interface"?t[9]:void 0),Y(e,"mousemove",t[69]==="interface"?t[10]:void 0),Y(e,"mouseup",t[69]==="interface"?t[11]:void 0),Y(e,"mouseout",t[69]==="interface"?t[11]:void 0),Y(e,"mouseout",function(){Ve(t[69]==="interface"?t[33]:void 0)&&(t[69]==="interface"?t[33]:void 0).apply(this,arguments)}),Y(e,"blur",t[69]==="interface"?t[11]:void 0),Y(e,"touchstart",t[69]==="interface"?t[9]:void 0),Y(e,"touchmove",t[69]==="interface"?t[10]:void 0),Y(e,"touchend",t[69]==="interface"?t[11]:void 0),Y(e,"touchcancel",t[69]==="interface"?t[11]:void 0),Y(e,"click",Lt(t[31]))],l=!0)},p(i,_){t=i,n!==t[69]&&(a(),n=t[69],s()),_[0]&128&&O(e,"lr",t[7]),_[0]&128&&O(e,"tb",!t[7])},d(i){i&&S(e),a(),l=!1,st(o)}}}function hr(t){let e,r,n,l,o=t[6]===0&&mt(),s=t[8],a=[];for(let i=0;i<s.length;i+=1)a[i]=gt(ht(t,s,i));return{c(){e=N("div"),o&&o.c(),r=W();for(let i=0;i<a.length;i+=1)a[i].c();g(e,"class","wrap svelte-1g1hqr7"),nt(()=>t[35].call(e))},m(i,_){y(i,e,_),o&&o.m(e,null),X(e,r);for(let f=0;f<a.length;f+=1)a[f].m(e,null);t[34](e),n=Mt(e,t[35].bind(e)),l=!0},p(i,_){if(i[6]===0?o?_[0]&64&&k(o,1):(o=mt(),o.c(),k(o,1),o.m(e,r)):o&&(re(),I(o,1,1,()=>{o=null}),ne()),_[0]&3975){s=i[8];let f;for(f=0;f<s.length;f+=1){const m=ht(i,s,f);a[f]?a[f].p(m,_):(a[f]=gt(m),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=s.length}},i(i){l||(k(o),l=!0)},o(i){I(o),l=!1},d(i){i&&S(e),o&&o.d(),qt(a,i),t[34](null),n()}}}let mr="#aaa";function dt(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}}function gr(t){const e=dr(t);if(e){const{r,g:n,b:l}=e;return(r*299+n*587+l*114)/1e3}return 0}function dr(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function br(t){const[e,r,n]=t.match(/\d+/g).map(Number);function l(o){const s=o.toString(16);return s.length===1?`0${s}`:s}return`#${l(e)}${l(r)}${l(n)}`}function pr(t,e,r){let n;const l=we();let{value:o}=e,{value_img:s}=e,{mode:a="sketch"}=e,{brush_color:i="#0b0f19"}=e,{brush_radius:_}=e,{source:f}=e,{width:m=400}=e,{height:u=200}=e,{container_height:h=200}=e,{shape:b}=e,A=localStorage.setItem("colorPickerEnable",!1),j=localStorage.setItem("transparentMask",!1),D=0,R=0,K,oe=m,ae=u,he;const ue=[{name:"interface",zIndex:15},{name:"drawing",zIndex:11},{name:"temp",zIndex:12},{name:"mask",zIndex:-1},{name:"temp_fake",zIndex:-2}];let M={},p={},Q=[],U=[],fe=!0,w=!0,P=!1,ee=!1,H=null,te=null,se=null,_e=0;function ge(){if(!b){p.temp.drawImage(s,0,0,m,u);return}let c=s.naturalWidth,C=s.naturalHeight;const T=b[0]/b[1],z=c/C;let F=0,L=0;T<z?(c=b[1]*z,C=b[1],F=(b[0]-c)/2):T>z?(c=b[0],C=b[0]/z,L=(b[1]-C)/2):(F=0,L=0,c=b[0],C=b[1]),p.temp.drawImage(s,F,L,c,C)}Tt(async()=>{Object.keys(M).forEach(c=>{r(28,p[c]=M[c].getContext("2d"),p)}),await Ce(),s&&(s.addEventListener("load",c=>{f==="webcam"?(p.temp.save(),p.temp.translate(m,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):ge(),p.drawing.drawImage(M.temp,0,0,m,u),ce()}),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(m,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):ge(),p.drawing.drawImage(M.temp,0,0,m,u),Ie({lines:U.slice()}),ce()},100)),r(30,H=new cr({radius:_*.05,enabled:!0,initialPoint:{x:m/2,y:u/2}})),se=new Gt((c,C,...T)=>{je(c,C)}),se.observe(te),Me(),r(26,K=!0),requestAnimationFrame(()=>{Ee(),requestAnimationFrame(()=>{be()})})});function Ee(){const c=m/2,C=u/2;H.update({x:c,y:C},{both:!0}),H.update({x:c,y:C},{both:!1}),fe=!0,w=!0}jt(()=>{r(26,K=!1),se.unobserve(te)});function Be(c=!1){let C=U.slice(0,-1);c&&(C=[],r(29,U=[]),r(6,_e=0),localStorage.setItem("resetLines","false")),ze(),s&&(f==="webcam"?(p.temp.save(),p.temp.translate(m,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):ge(),(!U||!U.length)&&p.drawing.drawImage(M.temp,0,0,m,u)),Ie({lines:C}),r(6,_e=C.length),U.length&&r(29,U=C),U.length==0&&l("clear"),ce()}function ve(){ze(),s&&ge(),U.length==0&&l("clear"),r(6,_e=U.length),Ie({lines:U}),ce()}let Ie=({lines:c})=>{const C=i;c.forEach(T=>{let{points:z,brush_color:F,brush_radius:L}=T;Se(a==="mask"?{points:z,brush_color:C,brush_radius:L}:{points:z,brush_color:F,brush_radius:L}),a==="mask"&&Ne({points:z,brush_color:C,brush_radius:L}),Q=z}),Oe({brush_color:i,brush_radius:_}),a==="mask"&&Pe()},Qe=c=>{c.preventDefault();const{x:C,y:T}=Ue(c);if(!(!c.touches&&c.button!==0)){if(A=localStorage.getItem("colorPickerEnable")==="true",A&&a!=="mask"){r(15,i=Ke(C,T));const z=br(i);vt.set(z),localStorage.setItem("colorPickerEnable","false");return}ee=!0,c.touches&&c.touches.length>0&&H.update({x:C,y:T},{both:!0}),We(C,T),r(6,_e+=1)}},Re=c=>{c.preventDefault(),localStorage.getItem("resetLines")==="true"&&U.length>0?Be(!0):localStorage.setItem("resetLines","false"),localStorage.getItem("fillCanvasWhite")==="true"&&($e(),localStorage.setItem("fillCanvasWhite",!1));const{x:C,y:T}=Ue(c);r(1,D=C),r(2,R=T),We(C,T),localStorage.setItem("overCanvas","true")},Ge=c=>{c.preventDefault(),Re(c),P=!1,ee=!1,Oe(),j=localStorage.getItem("transparentMask")==="true",j&&ve(),a==="mask"&&Pe()},Fe=0,De=0,Le=0,qe=!1,je=async()=>{if(b&&te){const T=te?.getBoundingClientRect(),z=b[0]/b[1],F=T.width/T.height;r(7,qe=z<F)}if(m===Fe&&u===De&&Le===h)return;const c={width:m,height:u},C={height:h,width:h*(c.width/c.height)};await Promise.all([de(M.interface,c,C),de(M.drawing,c,C),de(M.temp,c,C),de(M.temp_fake,c,C),de(M.mask,c,C,!1)]),_||r(12,_=20*(c.width/C.width)),Me({once:!0}),setTimeout(()=>{De=u,Fe=m,Le=h},10),await Ce(),be()},de=async(c,C,T,z=!0)=>{if(!K)return;await Ce();const F=window.devicePixelRatio||1;c.width=C.width*(z?F:1),c.height=C.height*(z?F:1);const L=c.getContext("2d");z&&L.scale(F,F),c.style.width=`${T.width}px`,c.style.height=`${T.height}px`},Ue=c=>{const C=M.interface.getBoundingClientRect();let T=c.clientX,z=c.clientY;return c.changedTouches&&c.changedTouches.length>0&&(T=c.changedTouches[0].clientX,z=c.changedTouches[0].clientY),{x:(T-C.left)/C.width*m,y:(z-C.top)/C.height*u}};function Ze(){if(A=localStorage.getItem("colorPickerEnable")==="true",A&&a!=="mask")for(const c in M)r(0,M[c].style.cursor="crosshair",M);else for(const c in M)r(0,M[c].style.cursor="none",M)}let We=(c,C)=>{if(A=localStorage.getItem("colorPickerEnable")==="true",Ze(),A&&a!=="mask")return;H.update({x:c,y:C});const T=!H.isEnabled();(ee&&!P||T&&ee)&&(P=!0,Q.push(H.brush.toObject())),P&&(Q.push(H.brush.toObject()),Se({points:Q,brush_color:i,brush_radius:_}),a==="mask"&&Ne({points:Q,brush_color:i,brush_radius:_})),fe=!0},Se=({points:c,brush_color:C,brush_radius:T})=>{if(!c||c.length<2||(r(28,p.temp.lineJoin="round",p),r(28,p.temp.lineCap="round",p),r(28,p.temp.strokeStyle=C,p),r(28,p.temp.lineWidth=T,p),!c||c.length<2))return;let z=c[0],F=c[1];p.temp.moveTo(F.x,F.y),p.temp.beginPath();for(var L=1,Ae=c.length;L<Ae;L++){var Te=dt(z,F);p.temp.quadraticCurveTo(z.x,z.y,Te.x,Te.y),z=c[L],F=c[L+1]}p.temp.lineTo(z.x,z.y),p.temp.stroke()},Ne=({points:c,brush_color:C,brush_radius:T})=>{if(!c||c.length<2)return;r(28,p.temp_fake.lineJoin="round",p),r(28,p.temp_fake.lineCap="round",p),r(28,p.temp_fake.strokeStyle="#fff",p),r(28,p.temp_fake.lineWidth=T,p);let z=c[0],F=c[1];p.temp_fake.moveTo(F.x,F.y),p.temp_fake.beginPath();for(var L=1,Ae=c.length;L<Ae;L++){var Te=dt(z,F);p.temp_fake.quadraticCurveTo(z.x,z.y,Te.x,Te.y),z=c[L],F=c[L+1]}p.temp_fake.lineTo(z.x,z.y),p.temp_fake.stroke()};function Ke(c,C){const T=p.drawing.getImageData(c,C,1,1),[z,F,L,Ae]=T.data;return`rgb(${z}, ${F}, ${L})`}let Pe=()=>{Q.length<1||(Q.length=0,p.mask.drawImage(M.temp_fake,0,0,m,u),ce())},Oe=()=>{Q.length<1||(U.push({points:Q.slice(),brush_color:i,brush_radius:_}),a!=="mask"&&(Q.length=0),p.drawing.drawImage(M.temp,0,0,m,u),ce())},ce=()=>{const c=He();l("change",c)};function be(){return r(29,U=[]),ze(),r(6,_e=0),!0}function ze(){w=!0,p.temp.clearRect(0,0,m,u),r(28,p.temp.fillStyle=a==="mask"?"transparent":"#FFFFFF",p),p.temp.fillRect(0,0,m,u),a==="mask"&&(p.temp_fake.clearRect(0,0,M.temp_fake.width,M.temp_fake.height),p.mask.clearRect(0,0,m,u),r(28,p.mask.fillStyle="#000",p),p.mask.fillRect(0,0,m,u))}function $e(){a!=="mask"&&(r(28,p.temp.fillStyle="#FFFFFF",p),p.temp.fillRect(0,0,m,u),r(28,p.drawing.fillStyle="#FFFFFF",p),p.drawing.fillRect(0,0,m,u),r(29,U=[]),r(6,_e=0))}let Me=({once:c=!1}={})=>{if(fe||w){const C=H.getPointerCoordinates(),T=H.getBrushCoordinates();xe(p.interface,C,T),fe=!1,w=!1}c||window.requestAnimationFrame(()=>{Me()})},xe=(c,C,T)=>{c.clearRect(0,0,m,u);let z=T.x,F=T.y;D&&R&&(z=D,F=R),c.beginPath(),c.fillStyle=i;const L=localStorage.getItem("brushOutline")==="true";if(L){const Ae=gr(i);c.strokeStyle=Ae>128?"black":"white",_>180?c.lineWidth=4:_>80?c.lineWidth=3:_>20?c.lineWidth=2:c.lineWidth=1}c.arc(z,F,_/2,0,Math.PI*2,!0),c.fill(),L&&c.stroke(),c.beginPath(),c.fillStyle=mr,c.arc(z,F,n,0,Math.PI*2,!0),c.fill()};function He(){return a==="mask"?M.mask.toDataURL("image/jpg"):M.drawing.toDataURL("image/jpg")}function et(c){ke.call(this,t,c)}function tt(c,C){q[c?"unshift":"push"](()=>{M[C]=c,r(0,M)})}const rt=()=>{r(1,D=r(2,R=0)),localStorage.setItem("overCanvas","false")};function d(c){q[c?"unshift":"push"](()=>{te=c,r(5,te)})}function pe(){oe=this.offsetWidth,ae=this.offsetHeight,r(3,oe),r(4,ae)}return t.$$set=c=>{"value"in c&&r(16,o=c.value),"value_img"in c&&r(17,s=c.value_img),"mode"in c&&r(18,a=c.mode),"brush_color"in c&&r(15,i=c.brush_color),"brush_radius"in c&&r(12,_=c.brush_radius),"source"in c&&r(19,f=c.source),"width"in c&&r(13,m=c.width),"height"in c&&r(14,u=c.height),"container_height"in c&&r(20,h=c.container_height),"shape"in c&&r(21,b=c.shape)},t.$$.update=()=>{t.$$.dirty[0]&2121728&&b&&(m||u)&&(r(13,m=b[0]),r(14,u=b[1])),t.$$.dirty[0]&67174400&&K&&!o&&be(),t.$$.dirty[0]&1007312897&&K&&s!==he&&(r(27,he=s),be(),setTimeout(()=>{f==="webcam"?(p.temp.save(),p.temp.translate(m,0),p.temp.scale(-1,1),p.temp.drawImage(s,0,0),p.temp.restore()):ge(),p.drawing.drawImage(M.temp,0,0,m,u),Ie({lines:U.slice()}),ce()},50)),t.$$.dirty[0]&1073745920&&H&&(Ee(),H.setRadius(_*.05)),t.$$.dirty[0]&24576&&(m||u)&&je(),t.$$.dirty[0]&4096&&(n=_*.075)},[M,D,R,oe,ae,te,_e,qe,ue,Qe,Re,Ge,_,m,u,i,o,s,a,f,h,b,Be,ve,be,He,K,he,p,U,H,et,tt,rt,d,pe]}class lt extends le{constructor(e){super(),ie(this,e,pr,hr,x,{value:16,value_img:17,mode:18,brush_color:15,brush_radius:12,source:19,width:13,height:14,container_height:20,shape:21,undo:22,redraw:23,clear:24,get_image_data:25},null,[-1,-1,-1])}get undo(){return this.$$.ctx[22]}get redraw(){return this.$$.ctx[23]}get clear(){return this.$$.ctx[24]}get get_image_data(){return this.$$.ctx[25]}}function kr(t){let e,r,n,l,o,s,a;return r=new ye({props:{Icon:Zt,label:"Undo"}}),r.$on("click",t[1]),l=new ye({props:{Icon:xt,label:"Redraw"}}),l.$on("click",t[2]),s=new ye({props:{Icon:$t,label:"Clear"}}),s.$on("click",t[3]),{c(){e=N("div"),E(r.$$.fragment),n=W(),E(l.$$.fragment),o=W(),E(s.$$.fragment),g(e,"class","svelte-17iq5p5")},m(i,_){y(i,e,_),B(r,e,null),X(e,n),B(l,e,null),X(e,o),B(s,e,null),a=!0},p:V,i(i){a||(k(r.$$.fragment,i),k(l.$$.fragment,i),k(s.$$.fragment,i),a=!0)},o(i){I(r.$$.fragment,i),I(l.$$.fragment,i),I(s.$$.fragment,i),a=!1},d(i){i&&S(e),v(r),v(l),v(s)}}}function wr(t){const e=we();return[e,()=>e("undo"),()=>e("redraw"),o=>{e("clear"),o.stopPropagation()}]}class it extends le{constructor(e){super(),ie(this,e,wr,kr,x,{})}}function bt(t){let e,r,n,l,o;return{c(){e=N("input"),g(e,"aria-label","Brush radius"),g(e,"type","range"),g(e,"min",r=.5*(t[2]/t[6])),g(e,"max",n=75*(t[2]/t[6])),g(e,"class","svelte-p4aq0j")},m(s,a){y(s,e,a),Ye(e,t[0]),l||(o=[Y(e,"change",t[11]),Y(e,"input",t[11])],l=!0)},p(s,a){a&68&&r!==(r=.5*(s[2]/s[6]))&&g(e,"min",r),a&68&&n!==(n=75*(s[2]/s[6]))&&g(e,"max",n),a&1&&Ye(e,s[0])},d(s){s&&S(e),l=!1,st(o)}}}function Ir(t){let e,r,n,l;r=new ye({props:{Icon:or,label:"Select brush color"}}),r.$on("click",t[12]);let o=t[5]&&pt(t);return{c(){e=N("span"),E(r.$$.fragment),n=W(),o&&o.c(),g(e,"class","col svelte-p4aq0j")},m(s,a){y(s,e,a),B(r,e,null),X(e,n),o&&o.m(e,null),l=!0},p(s,a){s[5]?o?o.p(s,a):(o=pt(s),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},i(s){l||(k(r.$$.fragment,s),l=!0)},o(s){I(r.$$.fragment,s),l=!1},d(s){s&&S(e),v(r),o&&o.d()}}}function pt(t){let e,r,n;return{c(){e=N("input"),g(e,"aria-label","Brush color"),g(e,"type","color"),g(e,"class","svelte-p4aq0j")},m(l,o){y(l,e,o),Ye(e,t[1]),r||(n=[Y(e,"change",t[13]),Y(e,"input",t[14])],r=!0)},p(l,o){o&2&&Ye(e,l[1])},d(l){l&&S(e),r=!1,st(n)}}}function Ar(t){let e,r,n,l,o,s;n=new ye({props:{Icon:lr,label:"Use brush"}}),n.$on("click",t[10]);let a=t[4]&&bt(t),i=Ir(t);return{c(){e=N("div"),r=N("span"),E(n.$$.fragment),l=W(),a&&a.c(),o=W(),i&&i.c(),g(r,"class","brush svelte-p4aq0j"),g(e,"class","wrap svelte-p4aq0j")},m(_,f){y(_,e,f),X(e,r),B(n,r,null),X(r,l),a&&a.m(r,null),X(e,o),i&&i.m(e,null),s=!0},p(_,[f]){_[4]?a?a.p(_,f):(a=bt(_),a.c(),a.m(r,null)):a&&(a.d(1),a=null),i.p(_,f)},i(_){s||(k(n.$$.fragment,_),k(i),s=!0)},o(_){I(n.$$.fragment,_),I(i),s=!1},d(_){_&&S(e),v(n),a&&a.d(),i&&i.d()}}}function Cr(t,e,r){let n;const l=we();let o=!1,s=!1,{brush_radius:a=20}=e,{container_height:i}=e,{img_width:_}=e,{img_height:f}=e,{mode:m="other"}=e,{brush_color:u="#000"}=e;vt.subscribe(R=>{r(1,u=R)});const h=()=>r(4,o=!o);function b(){a=Ut(this.value),r(0,a)}const A=()=>r(5,s=!s),j=()=>{m==="mask"&&l("redraw")};function D(){u=this.value,r(1,u)}return t.$$set=R=>{"brush_radius"in R&&r(0,a=R.brush_radius),"container_height"in R&&r(8,i=R.container_height),"img_width"in R&&r(2,_=R.img_width),"img_height"in R&&r(9,f=R.img_height),"mode"in R&&r(3,m=R.mode),"brush_color"in R&&r(1,u=R.brush_color)},t.$$.update=()=>{t.$$.dirty&772&&r(6,n=i*(_/f))},[a,u,_,m,o,s,n,l,i,f,h,b,A,j,D]}class ot extends le{constructor(e){super(),ie(this,e,Cr,Ar,x,{brush_radius:0,container_height:8,img_width:2,img_height:9,mode:3,brush_color:1})}}function yr(t){let e,r;return{c(){e=N("img"),J(e.src,r=t[0].image||t[0])||g(e,"src",r),g(e,"alt",""),g(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!J(e.src,r=n[0].image||n[0])&&g(e,"src",r),l[0]&544&&O(e,"webcam",n[5]==="webcam"&&n[9])},i:V,o:V,d(n){n&&S(e)}}}function Sr(t){let e=t[22],r,n,l,o=kt(t),s=t[17]>0&&wt(t);return{c(){o.c(),r=W(),s&&s.c(),n=me()},m(a,i){o.m(a,i),y(a,r,i),s&&s.m(a,i),y(a,n,i),l=!0},p(a,i){i[0]&4194304&&x(e,e=a[22])?(o.d(1),o=kt(a),o.c(),o.m(r.parentNode,r)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&k(s,1)):(s=wt(a),s.c(),k(s,1),s.m(n.parentNode,n)):s&&(re(),I(s,1,1,()=>{s=null}),ne())},i(a){l||(k(s),l=!0)},o(a){I(s),l=!1},d(a){o.d(a),a&&S(r),s&&s.d(a),a&&S(n)}}}function zr(t){let e,r,n,l,o;return e=new Je({props:{editable:!0}}),e.$on("edit",t[53]),e.$on("clear",t[25]),{c(){E(e.$$.fragment),r=W(),n=N("img"),J(n.src,l=t[0])||g(n,"src",l),g(n,"alt",""),g(n,"class","svelte-rlgzoo"),O(n,"webcam",t[5]==="webcam"&&t[9])},m(s,a){B(e,s,a),y(s,r,a),y(s,n,a),o=!0},p(s,a){(!o||a[0]&1&&!J(n.src,l=s[0]))&&g(n,"src",l),a[0]&544&&O(n,"webcam",s[5]==="webcam"&&s[9])},i(s){o||(k(e.$$.fragment,s),o=!0)},o(s){I(e.$$.fragment,s),o=!1},d(s){v(e,s),s&&S(r),s&&S(n)}}}function Mr(t){let e,r,n,l,o={image:t[0]};return e=new Bt({props:o}),t[51](e),e.$on("crop",t[26]),n=new Je({}),n.$on("clear",t[52]),{c(){E(e.$$.fragment),r=W(),E(n.$$.fragment)},m(s,a){B(e,s,a),y(s,r,a),B(n,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(k(e.$$.fragment,s),k(n.$$.fragment,s),l=!0)},o(s){I(e.$$.fragment,s),I(n.$$.fragment,s),l=!1},d(s){t[51](null),v(e,s),s&&S(r),v(n,s)}}}function Tr(t){let e,r,n=t[5]==="webcam"&&!t[22]&&At(t);return{c(){n&&n.c(),e=me()},m(l,o){n&&n.m(l,o),y(l,e,o),r=!0},p(l,o){l[5]==="webcam"&&!l[22]?n?(n.p(l,o),o[0]&4194336&&k(n,1)):(n=At(l),n.c(),k(n,1),n.m(e.parentNode,e)):n&&(re(),I(n,1,1,()=>{n=null}),ne())},i(l){r||(k(n),r=!0)},o(l){I(n),r=!1},d(l){n&&n.d(l),l&&S(e)}}}function Er(t){let e,r,n,l,o,s,a;e=new it({}),e.$on("undo",t[42]),e.$on("redraw",t[43]),e.$on("clear",t[28]);let i=t[1]==="color-sketch"&&Ct(t);function _(u){t[46](u)}function f(u){t[47](u)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],shape:t[6]};return t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),l=new lt({props:m}),q.push(()=>Z(l,"brush_radius",_)),q.push(()=>Z(l,"brush_color",f)),t[48](l),l.$on("change",t[26]),l.$on("clear",t[28]),{c(){E(e.$$.fragment),r=W(),i&&i.c(),n=W(),E(l.$$.fragment)},m(u,h){B(e,u,h),y(u,r,h),i&&i.m(u,h),y(u,n,h),B(l,u,h),a=!0},p(u,h){u[1]==="color-sketch"?i?(i.p(u,h),h[0]&2&&k(i,1)):(i=Ct(u),i.c(),k(i,1),i.m(n.parentNode,n)):i&&(re(),I(i,1,1,()=>{i=null}),ne());const b={};h[0]&1&&(b.value=u[0]),h[0]&4096&&(b.mode=u[12]),h[0]&2228224&&(b.width=u[17]||u[21]),h[0]&1114112&&(b.height=u[16]||u[20]),h[0]&1310720&&(b.container_height=u[18]||u[20]),h[0]&64&&(b.shape=u[6]),!o&&h[0]&4&&(o=!0,b.brush_radius=u[2],G(()=>o=!1)),!s&&h[0]&8388608&&(s=!0,b.brush_color=u[23],G(()=>s=!1)),l.$set(b)},i(u){a||(k(e.$$.fragment,u),k(i),k(l.$$.fragment,u),a=!0)},o(u){I(e.$$.fragment,u),I(i),I(l.$$.fragment,u),a=!1},d(u){v(e,u),u&&S(r),i&&i.d(u),u&&S(n),t[48](null),v(l,u)}}}function Br(t){let e,r,n;function l(s){t[41](s)}let o={filetype:"image/*",include_file_metadata:!1,disable_click:!!t[0],$$slots:{default:[qr]},$$scope:{ctx:t}};return t[11]!==void 0&&(o.dragging=t[11]),e=new er({props:o}),q.push(()=>Z(e,"dragging",l)),e.$on("load",t[24]),{c(){E(e.$$.fragment)},m(s,a){B(e,s,a),n=!0},p(s,a){const i={};a[0]&1&&(i.disable_click=!!s[0]),a[0]&16774887|a[2]&2&&(i.$$scope={dirty:a,ctx:s}),!r&&a[0]&2048&&(r=!0,i.dragging=s[11],G(()=>r=!1)),e.$set(i)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){v(e,s)}}}function kt(t){let e,r,n,l;return{c(){e=N("img"),g(e,"class","absolute-img svelte-rlgzoo"),J(e.src,r=t[22]||t[0]?.image||t[0])||g(e,"src",r),g(e,"alt","load-1"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[54](e),n||(l=Y(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!J(e.src,r=o[22]||o[0]?.image||o[0])&&g(e,"src",r),s[0]&544&&O(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&S(e),t[54](null),n=!1,l()}}}function wt(t){let e,r,n,l,o,s,a,i;function _(h){t[56](h)}function f(h){t[57](h)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5]};t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),e=new lt({props:m}),t[55](e),q.push(()=>Z(e,"brush_radius",_)),q.push(()=>Z(e,"brush_color",f)),e.$on("change",t[26]),o=new it({}),o.$on("undo",t[58]),o.$on("redraw",t[59]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&It(t);return{c(){E(e.$$.fragment),l=W(),E(o.$$.fragment),s=W(),u&&u.c(),a=me()},m(h,b){B(e,h,b),y(h,l,b),B(o,h,b),y(h,s,b),u&&u.m(h,b),y(h,a,b),i=!0},p(h,b){const A={};b[0]&1&&(A.value=h[0]),b[0]&4096&&(A.mode=h[12]),b[0]&2228224&&(A.width=h[17]||h[21]),b[0]&1114112&&(A.height=h[16]||h[20]),b[0]&1310720&&(A.container_height=h[18]||h[20]),b[0]&524288&&(A.value_img=h[19]),b[0]&32&&(A.source=h[5]),!r&&b[0]&4&&(r=!0,A.brush_radius=h[2],G(()=>r=!1)),!n&&b[0]&8388608&&(n=!0,A.brush_color=h[23],G(()=>n=!1)),e.$set(A),h[1]==="color-sketch"||h[1]==="sketch"?u?(u.p(h,b),b[0]&2&&k(u,1)):(u=It(h),u.c(),k(u,1),u.m(a.parentNode,a)):u&&(re(),I(u,1,1,()=>{u=null}),ne())},i(h){i||(k(e.$$.fragment,h),k(o.$$.fragment,h),k(u),i=!0)},o(h){I(e.$$.fragment,h),I(o.$$.fragment,h),I(u),i=!1},d(h){t[55](null),v(e,h),h&&S(l),v(o,h),h&&S(s),u&&u.d(h),h&&S(a)}}}function It(t){let e,r,n,l;function o(i){t[60](i)}function s(i){t[61](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new ot({props:a}),q.push(()=>Z(e,"brush_radius",o)),q.push(()=>Z(e,"brush_color",s)),{c(){E(e.$$.fragment)},m(i,_){B(e,i,_),l=!0},p(i,_){const f={};_[0]&1310720&&(f.container_height=i[18]||i[20]),_[0]&2228224&&(f.img_width=i[17]||i[21]),_[0]&1114112&&(f.img_height=i[16]||i[20]),_[0]&4096&&(f.mode=i[12]),!r&&_[0]&4&&(r=!0,f.brush_radius=i[2],G(()=>r=!1)),!n&&_[0]&8388608&&(n=!0,f.brush_color=i[23],G(()=>n=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){I(e.$$.fragment,i),l=!1},d(i){v(e,i)}}}function At(t){let e,r;return e=new Kt({props:{streaming:t[7],pending:t[8],mirror_webcam:t[9]}}),e.$on("capture",t[49]),e.$on("stream",t[26]),e.$on("error",t[50]),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},p(n,l){const o={};l[0]&128&&(o.streaming=n[7]),l[0]&256&&(o.pending=n[8]),l[0]&512&&(o.mirror_webcam=n[9]),e.$set(o)},i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Ct(t){let e,r,n,l;function o(i){t[44](i)}function s(i){t[45](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new ot({props:a}),q.push(()=>Z(e,"brush_radius",o)),q.push(()=>Z(e,"brush_color",s)),e.$on("redraw",function(){Ve(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){E(e.$$.fragment)},m(i,_){B(e,i,_),l=!0},p(i,_){t=i;const f={};_[0]&1310720&&(f.container_height=t[18]||t[20]),_[0]&2228224&&(f.img_width=t[17]||t[21]),_[0]&1114112&&(f.img_height=t[16]||t[20]),!r&&_[0]&4&&(r=!0,f.brush_radius=t[2],G(()=>r=!1)),!n&&_[0]&8388608&&(n=!0,f.brush_color=t[23],G(()=>n=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){I(e.$$.fragment,i),l=!1},d(i){v(e,i)}}}function vr(t){let e,r;return{c(){e=N("img"),J(e.src,r=t[0].image||t[0])||g(e,"src",r),g(e,"alt","hello"),g(e,"class","svelte-rlgzoo"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(n,l){y(n,e,l)},p(n,l){l[0]&1&&!J(e.src,r=n[0].image||n[0])&&g(e,"src",r),l[0]&544&&O(e,"webcam",n[5]==="webcam"&&n[9])},i:V,o:V,d(n){n&&S(e)}}}function Rr(t){let e=t[22],r,n,l,o=yt(t),s=t[17]>0&&St(t);return{c(){o.c(),r=W(),s&&s.c(),n=me()},m(a,i){o.m(a,i),y(a,r,i),s&&s.m(a,i),y(a,n,i),l=!0},p(a,i){i[0]&4194304&&x(e,e=a[22])?(o.d(1),o=yt(a),o.c(),o.m(r.parentNode,r)):o.p(a,i),a[17]>0?s?(s.p(a,i),i[0]&131072&&k(s,1)):(s=St(a),s.c(),k(s,1),s.m(n.parentNode,n)):s&&(re(),I(s,1,1,()=>{s=null}),ne())},i(a){l||(k(s),l=!0)},o(a){I(s),l=!1},d(a){o.d(a),a&&S(r),s&&s.d(a),a&&S(n)}}}function Fr(t){let e,r,n,l,o;return e=new Je({props:{editable:!0}}),e.$on("edit",t[32]),e.$on("clear",t[25]),{c(){E(e.$$.fragment),r=W(),n=N("img"),J(n.src,l=t[0])||g(n,"src",l),g(n,"alt",""),g(n,"class","svelte-rlgzoo"),O(n,"scale-x-[-1]",t[5]==="webcam"&&t[9])},m(s,a){B(e,s,a),y(s,r,a),y(s,n,a),o=!0},p(s,a){(!o||a[0]&1&&!J(n.src,l=s[0]))&&g(n,"src",l),a[0]&544&&O(n,"scale-x-[-1]",s[5]==="webcam"&&s[9])},i(s){o||(k(e.$$.fragment,s),o=!0)},o(s){I(e.$$.fragment,s),o=!1},d(s){v(e,s),s&&S(r),s&&S(n)}}}function Dr(t){let e,r,n,l,o={image:t[0]};return e=new Bt({props:o}),t[30](e),e.$on("crop",t[26]),n=new Je({}),n.$on("clear",t[31]),{c(){E(e.$$.fragment),r=W(),E(n.$$.fragment)},m(s,a){B(e,s,a),y(s,r,a),B(n,s,a),l=!0},p(s,a){const i={};a[0]&1&&(i.image=s[0]),e.$set(i)},i(s){l||(k(e.$$.fragment,s),k(n.$$.fragment,s),l=!0)},o(s){I(e.$$.fragment,s),I(n.$$.fragment,s),l=!1},d(s){t[30](null),v(e,s),s&&S(r),v(n,s)}}}function Lr(t){let e;const r=t[29].default,n=Wt(r,t,t[63],null);return{c(){n&&n.c()},m(l,o){n&&n.m(l,o),e=!0},p(l,o){n&&n.p&&(!e||o[2]&2)&&Nt(n,r,l,l[63],e?Ot(r,l[63],o,null):Pt(l[63]),null)},i(l){e||(k(n,l),e=!0)},o(l){I(n,l),e=!1},d(l){n&&n.d(l)}}}function yt(t){let e,r,n,l;return{c(){e=N("img"),g(e,"class","absolute-img svelte-rlgzoo"),J(e.src,r=t[22]||t[0].image||t[0])||g(e,"src",r),g(e,"data-source",t[14]),g(e,"data-isupload",t[15]),g(e,"alt","load-2"),O(e,"webcam",t[5]==="webcam"&&t[9])},m(o,s){y(o,e,s),t[33](e),n||(l=Y(e,"load",t[27]),n=!0)},p(o,s){s[0]&4194305&&!J(e.src,r=o[22]||o[0].image||o[0])&&g(e,"src",r),s[0]&16384&&g(e,"data-source",o[14]),s[0]&32768&&g(e,"data-isupload",o[15]),s[0]&544&&O(e,"webcam",o[5]==="webcam"&&o[9])},d(o){o&&S(e),t[33](null),n=!1,l()}}}function St(t){let e,r,n,l,o,s,a,i;function _(h){t[35](h)}function f(h){t[36](h)}let m={value:t[0],mode:t[12],width:t[17]||t[21],height:t[16]||t[20],container_height:t[18]||t[20],value_img:t[19],source:t[5],shape:t[6]};t[2]!==void 0&&(m.brush_radius=t[2]),t[23]!==void 0&&(m.brush_color=t[23]),e=new lt({props:m}),t[34](e),q.push(()=>Z(e,"brush_radius",_)),q.push(()=>Z(e,"brush_color",f)),e.$on("change",t[26]),e.$on("redraw",function(){Ve(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),o=new it({}),o.$on("undo",t[37]),o.$on("redraw",t[38]),o.$on("clear",t[28]);let u=(t[1]==="color-sketch"||t[1]==="sketch")&&zt(t);return{c(){E(e.$$.fragment),l=W(),E(o.$$.fragment),s=W(),u&&u.c(),a=me()},m(h,b){B(e,h,b),y(h,l,b),B(o,h,b),y(h,s,b),u&&u.m(h,b),y(h,a,b),i=!0},p(h,b){t=h;const A={};b[0]&1&&(A.value=t[0]),b[0]&4096&&(A.mode=t[12]),b[0]&2228224&&(A.width=t[17]||t[21]),b[0]&1114112&&(A.height=t[16]||t[20]),b[0]&1310720&&(A.container_height=t[18]||t[20]),b[0]&524288&&(A.value_img=t[19]),b[0]&32&&(A.source=t[5]),b[0]&64&&(A.shape=t[6]),!r&&b[0]&4&&(r=!0,A.brush_radius=t[2],G(()=>r=!1)),!n&&b[0]&8388608&&(n=!0,A.brush_color=t[23],G(()=>n=!1)),e.$set(A),t[1]==="color-sketch"||t[1]==="sketch"?u?(u.p(t,b),b[0]&2&&k(u,1)):(u=zt(t),u.c(),k(u,1),u.m(a.parentNode,a)):u&&(re(),I(u,1,1,()=>{u=null}),ne())},i(h){i||(k(e.$$.fragment,h),k(o.$$.fragment,h),k(u),i=!0)},o(h){I(e.$$.fragment,h),I(o.$$.fragment,h),I(u),i=!1},d(h){t[34](null),v(e,h),h&&S(l),v(o,h),h&&S(s),u&&u.d(h),h&&S(a)}}}function zt(t){let e,r,n,l;function o(i){t[39](i)}function s(i){t[40](i)}let a={container_height:t[18]||t[20],img_width:t[17]||t[21],img_height:t[16]||t[20],mode:t[12]};return t[2]!==void 0&&(a.brush_radius=t[2]),t[23]!==void 0&&(a.brush_color=t[23]),e=new ot({props:a}),q.push(()=>Z(e,"brush_radius",o)),q.push(()=>Z(e,"brush_color",s)),e.$on("redraw",function(){Ve(t[13].redraw())&&t[13].redraw().apply(this,arguments)}),{c(){E(e.$$.fragment)},m(i,_){B(e,i,_),l=!0},p(i,_){t=i;const f={};_[0]&1310720&&(f.container_height=t[18]||t[20]),_[0]&2228224&&(f.img_width=t[17]||t[21]),_[0]&1114112&&(f.img_height=t[16]||t[20]),_[0]&4096&&(f.mode=t[12]),!r&&_[0]&4&&(r=!0,f.brush_radius=t[2],G(()=>r=!1)),!n&&_[0]&8388608&&(n=!0,f.brush_color=t[23],G(()=>n=!1)),e.$set(f)},i(i){l||(k(e.$$.fragment,i),l=!0)},o(i){I(e.$$.fragment,i),l=!1},d(i){v(e,i)}}}function qr(t){let e,r,n,l;const o=[Lr,Dr,Fr,Rr,vr],s=[];function a(i,_){return i[0]===null&&!i[22]||i[7]?0:i[1]==="select"?1:i[1]==="editor"?2:(i[1]==="sketch"||i[1]==="color-sketch")&&(i[0]!==null||i[22])?3:4}return e=a(t),r=s[e]=o[e](t),{c(){r.c(),n=me()},m(i,_){s[e].m(i,_),y(i,n,_),l=!0},p(i,_){let f=e;e=a(i),e===f?s[e].p(i,_):(re(),I(s[f],1,1,()=>{s[f]=null}),ne(),r=s[e],r?r.p(i,_):(r=s[e]=o[e](i),r.c()),k(r,1),r.m(n.parentNode,n))},i(i){l||(k(r),l=!0)},o(i){I(r),l=!1},d(i){s[e].d(i),i&&S(n)}}}function jr(t){let e,r,n,l,o,s,a;e=new Et({props:{show_label:t[4],Icon:t[5]==="canvas"?ft:Xe,label:t[3]||(t[5]==="canvas"?"Sketch":"Image")}});const i=[Br,Er,Tr,Mr,zr,Sr,yr],_=[];function f(m,u){return m[5]==="upload"?0:m[5]==="canvas"?1:m[0]===null&&!m[22]||m[7]?2:m[1]==="select"?3:m[1]==="editor"?4:(m[1]==="sketch"||m[1]==="color-sketch")&&(m[0]!==null||m[22])?5:6}return l=f(t),o=_[l]=i[l](t),{c(){E(e.$$.fragment),r=W(),n=N("div"),o.c(),g(n,"data-testid","image"),g(n,"class","svelte-rlgzoo"),nt(()=>t[62].call(n)),O(n,"fixed-height",t[5]!=="webcam"||t[1]==="sketch"||t[1]==="color-sketch")},m(m,u){B(e,m,u),y(m,r,u),y(m,n,u),_[l].m(n,null),s=Mt(n,t[62].bind(n)),a=!0},p(m,u){const h={};u[0]&16&&(h.show_label=m[4]),u[0]&32&&(h.Icon=m[5]==="canvas"?ft:Xe),u[0]&40&&(h.label=m[3]||(m[5]==="canvas"?"Sketch":"Image")),e.$set(h);let b=l;l=f(m),l===b?_[l].p(m,u):(re(),I(_[b],1,1,()=>{_[b]=null}),ne(),o=_[l],o?o.p(m,u):(o=_[l]=i[l](m),o.c()),k(o,1),o.m(n,null)),u[0]&34&&O(n,"fixed-height",m[5]!=="webcam"||m[1]==="sketch"||m[1]==="color-sketch")},i(m){a||(k(e.$$.fragment,m),k(o),a=!0)},o(m){I(e.$$.fragment,m),I(o),a=!1},d(m){v(e,m),m&&S(r),m&&S(n),_[l].d(),s()}}}function Ur(t,e,r){let n,{$$slots:l={},$$scope:o}=e,{value:s}=e,{label:a=void 0}=e,{show_label:i}=e,{source:_="upload"}=e,{tool:f="editor"}=e,{shape:m}=e,{streaming:u=!1}=e,{pending:h=!1}=e,{mirror_webcam:b}=e,{brush_radius:A}=e,j,D,R="",K=!1;s&&(_==="upload"||_==="webcam")&&f==="sketch"&&(s={image:s,mask:null});function oe({detail:d}){f==="color-sketch"?r(22,se=d):r(0,s=(_==="upload"||_==="webcam")&&f==="sketch"?{image:d,mask:null}:d),r(15,K=!0),console.log(1),localStorage.setItem("resetLines","true"),ue("upload",d)}function ae({detail:d}){r(0,s=null),r(22,se=void 0),ue("clear")}async function he({detail:d},pe,c=!1){P==="mask"?_==="webcam"&&pe?r(0,s={image:d,mask:null}):r(0,s={image:typeof s=="string"?s:s?.image||null,mask:d}):(_==="upload"||_==="webcam")&&f==="sketch"?r(0,s={image:d,mask:null}):(R===""&&r(14,R=d),r(0,s=d)),await Ce(),ue(u?"stream":"edit")}const ue=we();let M=!1;function p(d){const pe=d.currentTarget;r(17,fe=pe.naturalWidth),r(16,U=pe.naturalHeight),r(18,w=pe.getBoundingClientRect().height)}async function Q(){j.clear(),await Ce(),r(0,s=null),r(22,se=void 0),r(14,R=""),r(15,K=!1)}let U=0,fe=0,w=0,P,ee,H,te,se;Tt(async()=>{f==="color-sketch"&&s&&typeof s=="string"&&(r(22,se=s),await Ce(),p({currentTarget:ee}))});function _e(d){q[d?"unshift":"push"](()=>{D=d,r(10,D),r(0,s)})}const ge=d=>(ae(d),r(1,f="editor")),Ee=()=>r(1,f="select");function Be(d){q[d?"unshift":"push"](()=>{ee=d,r(19,ee)})}function ve(d){q[d?"unshift":"push"](()=>{j=d,r(13,j)})}function Ie(d){A=d,r(2,A)}function Qe(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}const Re=()=>j.undo(),Ge=()=>j.redraw();function Fe(d){A=d,r(2,A)}function De(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}function Le(d){M=d,r(11,M)}const qe=()=>j.undo(),je=()=>j.redraw();function de(d){A=d,r(2,A)}function Ue(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}function Ze(d){A=d,r(2,A)}function We(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}function Se(d){q[d?"unshift":"push"](()=>{j=d,r(13,j)})}const Ne=d=>f==="color-sketch"?oe(d):he(d,!0,"pizda");function Ke(d){ke.call(this,t,d)}function Pe(d){q[d?"unshift":"push"](()=>{D=d,r(10,D),r(0,s)})}const Oe=d=>(ae(d),r(1,f="editor")),ce=()=>r(1,f="select");function be(d){q[d?"unshift":"push"](()=>{ee=d,r(19,ee)})}function ze(d){q[d?"unshift":"push"](()=>{j=d,r(13,j)})}function $e(d){A=d,r(2,A)}function Me(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}const xe=()=>j.undo(),He=()=>j.redraw();function et(d){A=d,r(2,A)}function tt(d){n=d,r(23,n),r(12,P),r(5,_),r(1,f)}function rt(){H=this.offsetHeight,te=this.offsetWidth,r(20,H),r(21,te)}return t.$$set=d=>{"value"in d&&r(0,s=d.value),"label"in d&&r(3,a=d.label),"show_label"in d&&r(4,i=d.show_label),"source"in d&&r(5,_=d.source),"tool"in d&&r(1,f=d.tool),"shape"in d&&r(6,m=d.shape),"streaming"in d&&r(7,u=d.streaming),"pending"in d&&r(8,h=d.pending),"mirror_webcam"in d&&r(9,b=d.mirror_webcam),"brush_radius"in d&&r(2,A=d.brush_radius),"$$scope"in d&&r(63,o=d.$$scope)},t.$$.update=()=>{t.$$.dirty[0]&1&&ue("change",s),t.$$.dirty[0]&2048&&ue("drag",M),t.$$.dirty[0]&34&&(_==="canvas"&&f==="sketch"?r(12,P="bw-sketch"):f==="color-sketch"?r(12,P="color-sketch"):(_==="upload"||_==="webcam")&&f==="sketch"?r(12,P="mask"):r(12,P="editor")),t.$$.dirty[0]&4096&&r(23,n=P=="mask"?"#000000":"#000"),t.$$.dirty[0]&1&&(s===null||s.image===null&&s.mask===null)&&r(22,se=void 0),t.$$.dirty[0]&1025&&D&&(s?(r(10,D.image=s,D),D.create()):D.destroy())},[s,f,A,a,i,_,m,u,h,b,D,M,P,j,R,K,U,fe,w,ee,H,te,se,n,oe,ae,he,p,Q,l,_e,ge,Ee,Be,ve,Ie,Qe,Re,Ge,Fe,De,Le,qe,je,de,Ue,Ze,We,Se,Ne,Ke,Pe,Oe,ce,be,ze,$e,Me,xe,He,et,tt,rt,o]}class Wr extends le{constructor(e){super(),ie(this,e,Ur,jr,x,{value:0,label:3,show_label:4,source:5,tool:1,shape:6,streaming:7,pending:8,mirror_webcam:9,brush_radius:2},null,[-1,-1,-1])}}function Nr(t){let e,r,n,l,o,s,a;return n=new ye({props:{Icon:rr,label:"Download"}}),{c(){e=N("div"),r=N("a"),E(n.$$.fragment),l=W(),o=N("img"),g(r,"href",t[0]),g(r,"target",window.__is_colab__?"_blank":null),g(r,"download","image"),g(e,"class","download svelte-kt1jzh"),J(o.src,s=t[0])||g(o,"src",s),g(o,"alt",""),g(o,"class","svelte-kt1jzh")},m(i,_){y(i,e,_),X(e,r),B(n,r,null),y(i,l,_),y(i,o,_),a=!0},p(i,_){(!a||_&1)&&g(r,"href",i[0]),(!a||_&1&&!J(o.src,s=i[0]))&&g(o,"src",s)},i(i){a||(k(n.$$.fragment,i),a=!0)},o(i){I(n.$$.fragment,i),a=!1},d(i){i&&S(e),v(n),i&&S(l),i&&S(o)}}}function Pr(t){let e,r;return e=new tr({props:{size:"large",unpadded_box:!0,$$slots:{default:[Or]},$$scope:{ctx:t}}}),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},p(n,l){const o={};l&16&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Or(t){let e,r;return e=new Xe({}),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Hr(t){let e,r,n,l,o,s;e=new Et({props:{show_label:t[2],Icon:Xe,label:t[1]||"Image"}});const a=[Pr,Nr],i=[];function _(f,m){return f[0]===null?0:1}return n=_(t),l=i[n]=a[n](t),{c(){E(e.$$.fragment),r=W(),l.c(),o=me()},m(f,m){B(e,f,m),y(f,r,m),i[n].m(f,m),y(f,o,m),s=!0},p(f,[m]){const u={};m&4&&(u.show_label=f[2]),m&2&&(u.label=f[1]||"Image"),e.$set(u);let h=n;n=_(f),n===h?i[n].p(f,m):(re(),I(i[h],1,1,()=>{i[h]=null}),ne(),l=i[n],l?l.p(f,m):(l=i[n]=a[n](f),l.c()),k(l,1),l.m(o.parentNode,o))},i(f){s||(k(e.$$.fragment,f),k(l),s=!0)},o(f){I(e.$$.fragment,f),I(l),s=!1},d(f){v(e,f),f&&S(r),i[n].d(f),f&&S(o)}}}function Yr(t,e,r){let{value:n}=e,{label:l=void 0}=e,{show_label:o}=e;const s=we();return t.$$set=a=>{"value"in a&&r(0,n=a.value),"label"in a&&r(1,l=a.label),"show_label"in a&&r(2,o=a.show_label)},t.$$.update=()=>{t.$$.dirty&1&&n&&s("change",n)},[n,l,o]}class Xr extends le{constructor(e){super(),ie(this,e,Yr,Hr,x,{value:0,label:1,show_label:2})}}function Vr(t){let e,r,n;function l(s){t[17](s)}let o={brush_radius:t[14],shape:t[13],source:t[5],tool:t[6],label:t[7],show_label:t[8],pending:t[10],streaming:t[9],mirror_webcam:t[12],$$slots:{default:[Qr]},$$scope:{ctx:t}};return t[0]!==void 0&&(o.value=t[0]),e=new Wr({props:o}),q.push(()=>Z(e,"value",l)),e.$on("edit",t[18]),e.$on("clear",t[19]),e.$on("change",t[20]),e.$on("stream",t[21]),e.$on("drag",t[22]),e.$on("upload",t[23]),e.$on("error",t[24]),{c(){E(e.$$.fragment)},m(s,a){B(e,s,a),n=!0},p(s,a){const i={};a&16384&&(i.brush_radius=s[14]),a&8192&&(i.shape=s[13]),a&32&&(i.source=s[5]),a&64&&(i.tool=s[6]),a&128&&(i.label=s[7]),a&256&&(i.show_label=s[8]),a&1024&&(i.pending=s[10]),a&512&&(i.streaming=s[9]),a&4096&&(i.mirror_webcam=s[12]),a&67108864&&(i.$$scope={dirty:a,ctx:s}),!r&&a&1&&(r=!0,i.value=s[0],G(()=>r=!1)),e.$set(i)},i(s){n||(k(e.$$.fragment,s),n=!0)},o(s){I(e.$$.fragment,s),n=!1},d(s){v(e,s)}}}function Jr(t){let e,r;return e=new Xr({props:{value:t[0],label:t[7],show_label:t[8]}}),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},p(n,l){const o={};l&1&&(o.value=n[0]),l&128&&(o.label=n[7]),l&256&&(o.show_label=n[8]),e.$set(o)},i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Qr(t){let e,r;return e=new nr({props:{type:"image"}}),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},p:V,i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Gr(t){let e,r,n,l,o,s;const a=[t[1]];let i={};for(let u=0;u<a.length;u+=1)i=Ht(i,a[u]);e=new Yt({props:i});const _=[Jr,Vr],f=[];function m(u,h){return u[15]==="static"?0:1}return n=m(t),l=f[n]=_[n](t),{c(){E(e.$$.fragment),r=W(),l.c(),o=me()},m(u,h){B(e,u,h),y(u,r,h),f[n].m(u,h),y(u,o,h),s=!0},p(u,h){const b=h&2?Xt(a,[Vt(u[1])]):{};e.$set(b);let A=n;n=m(u),n===A?f[n].p(u,h):(re(),I(f[A],1,1,()=>{f[A]=null}),ne(),l=f[n],l?l.p(u,h):(l=f[n]=_[n](u),l.c()),k(l,1),l.m(o.parentNode,o))},i(u){s||(k(e.$$.fragment,u),k(l),s=!0)},o(u){I(e.$$.fragment,u),I(l),s=!1},d(u){v(e,u),u&&S(r),f[n].d(u),u&&S(o)}}}function Zr(t){let e,r;return e=new Jt({props:{visible:t[4],variant:t[15]==="dynamic"&&t[0]===null&&t[5]==="upload"?"dashed":"solid",border_mode:t[16]?"focus":"base",padding:!1,elem_id:t[2],elem_classes:t[3],style:{height:t[11].height,width:t[11].width},allow_overflow:!1,$$slots:{default:[Gr]},$$scope:{ctx:t}}}),{c(){E(e.$$.fragment)},m(n,l){B(e,n,l),r=!0},p(n,[l]){const o={};l&16&&(o.visible=n[4]),l&32801&&(o.variant=n[15]==="dynamic"&&n[0]===null&&n[5]==="upload"?"dashed":"solid"),l&65536&&(o.border_mode=n[16]?"focus":"base"),l&4&&(o.elem_id=n[2]),l&8&&(o.elem_classes=n[3]),l&2048&&(o.style={height:n[11].height,width:n[11].width}),l&67237859&&(o.$$scope={dirty:l,ctx:n}),e.$set(o)},i(n){r||(k(e.$$.fragment,n),r=!0)},o(n){I(e.$$.fragment,n),r=!1},d(n){v(e,n)}}}function Kr(t,e,r){let{elem_id:n=""}=e,{elem_classes:l=[]}=e,{visible:o=!0}=e,{value:s=null}=e,{source:a="upload"}=e,{tool:i="editor"}=e,{label:_}=e,{show_label:f}=e,{streaming:m}=e,{pending:u}=e,{style:h={}}=e,{mirror_webcam:b}=e,{shape:A}=e,{brush_radius:j}=e,{loading_status:D}=e,{mode:R}=e;const K=we();let oe;function ae(w){s=w,r(0,s)}function he(w){ke.call(this,t,w)}function ue(w){ke.call(this,t,w)}function M(w){ke.call(this,t,w)}function p(w){ke.call(this,t,w)}const Q=({detail:w})=>r(16,oe=w);function U(w){ke.call(this,t,w)}const fe=({detail:w})=>{r(1,D=D||{}),r(1,D.status="error",D),r(1,D.message=w,D)};return t.$$set=w=>{"elem_id"in w&&r(2,n=w.elem_id),"elem_classes"in w&&r(3,l=w.elem_classes),"visible"in w&&r(4,o=w.visible),"value"in w&&r(0,s=w.value),"source"in w&&r(5,a=w.source),"tool"in w&&r(6,i=w.tool),"label"in w&&r(7,_=w.label),"show_label"in w&&r(8,f=w.show_label),"streaming"in w&&r(9,m=w.streaming),"pending"in w&&r(10,u=w.pending),"style"in w&&r(11,h=w.style),"mirror_webcam"in w&&r(12,b=w.mirror_webcam),"shape"in w&&r(13,A=w.shape),"brush_radius"in w&&r(14,j=w.brush_radius),"loading_status"in w&&r(1,D=w.loading_status),"mode"in w&&r(15,R=w.mode)},t.$$.update=()=>{t.$$.dirty&1&&r(0,s=s||null),t.$$.dirty&1&&K("change")},[s,D,n,l,o,a,i,_,f,m,u,h,b,A,j,R,oe,ae,he,ue,M,p,Q,U,fe]}class $r extends le{constructor(e){super(),ie(this,e,Kr,Zr,x,{elem_id:2,elem_classes:3,visible:4,value:0,source:5,tool:6,label:7,show_label:8,streaming:9,pending:10,style:11,mirror_webcam:12,shape:13,brush_radius:14,loading_status:1,mode:15})}}var mn=$r;const gn=["static","dynamic"],dn=t=>({type:{payload:"string"},description:{payload:"image data as base64 string"},example_data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAACklEQVR4nGMAAQAABQABDQottAAAAABJRU5ErkJggg=="});export{mn as Component,kn as ExampleComponent,dn as document,gn as modes};
//# sourceMappingURL=index.cd36f6e0.js.map
